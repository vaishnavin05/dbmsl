/* 2.	Unnamed PL/SQL code block: Use of Control structure and Exception handling is mandatory.
Write a PL/SQL block of code for the following requirements:- Consider table Stud(Roll, Att,Status) 
Write a PL/SQL block for following requirement and handle the exceptions. Roll no. of student will be entered by user.
Attendance of roll no. entered by user will be checked in Stud table. If attendance is less than 75% then display the message
“Term not granted” and set the status in stud table as “D”. Otherwise display message “Term granted” and set the status in stud table as “ND” 
*/ 

// Database Stud
CREATE TABLE Stud (
    Roll NUMBER PRIMARY KEY,
    Name VARCHAR2(50),
    Att NUMBER,
    Status CHAR(2)
);

INSERT INTO Stud VALUES (101, 'Rahul', 82, NULL);
INSERT INTO Stud VALUES (102, 'Priya', 65, NULL);
COMMIT;
// database Stud complete here 

SET SERVEROUTPUT ON;

DECLARE
    v_roll   NUMBER;
    v_att    NUMBER;
BEGIN
    v_roll := &Roll;

    SELECT att INTO v_att 
    FROM Stud 
    WHERE Roll = v_roll;

    IF v_att < 75 THEN
        DBMS_OUTPUT.PUT_LINE('Term not granted');
        UPDATE Stud
        SET Status = 'D'
        WHERE Roll = v_roll;
    ELSE
        DBMS_OUTPUT.PUT_LINE('Term granted');
        UPDATE Stud
        SET Status = 'ND'
        WHERE Roll = v_roll;
    END IF;

    COMMIT;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('Error: Roll number not found in Stud table.');
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('An unexpected error occurred: ' || SQLERRM);
END;
/
